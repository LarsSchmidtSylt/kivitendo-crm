Lx-Office CRM 1.4.0  


Installtion Lx-Office CRM
-------------------------

Dieses Installationsscript erzeugt die notwendigen Verzeichnisse und Tabellen
für die CRM und erweitert einige Tabellen der ERP. Die
Funktionstüchtigkeit der ERP wird dadurch nicht beeinträchtigt.

Achten Sie darauf, dass Sie über TCP Zugriff auf die PostgreSQL
haben (pg_hba.conf, postgresql.conf), was aber erledigt ist, wenn die ERP läuft.

Vorrausetzungen:
	Lx-Office ERP 2.6.x 
	PHP >= 4.2x
	PEAR::MDB2
	PEAR::MDB2#pgsql
	PEAR::Contact_Vcard_Build
	PEAR::Contact_Vcard_Parse
	PEAR::Mail_Mime oder php-mail-mime
		jpgraph
	oder
		PEAR::Image_Canvas
		PEAR::Image_Graph
	fpdf (http://www.fpdf.de/downloads/)
	fpdi (http://www.setasign.de/products/pdf-php-solutions/fpdi/downloads/)
	ttf-freefont
	php-gd,php-imap
	xajax (http://www.xajaxproject.org/)

z.B. debian:
apt-get install libapache2-mod-php5 php5-gd php5-imap php-mail-mime php5-pear php5-pgsql  php-fpdf php-mail-mime imagemagick

Achtung! Das PEAR-Paket Image_Graph und Image_Canvas sind noch nicht "stable". Daher mit :

	pear install -f Image_Graph
	pear install -f Image_Canvas

installieren.  Ein weiteres Paket ist dafür Vorraussetzung:
	PEAR::Image_Color  

jpgraph muß nicht mehr verwendet werden. Alternativ wird PEAR::Image_Graph verwendet.

PHP5:
Den Fehlerreporting evtl. etwas runterschrauben. 
error_reporting  =  E_ALL & ~E_NOTICE

Wird jpgraph verwendet, dann muß unbedingt jpgraph2 verwendet werden

PHP-Code wird angezeigt:
short_open_tag = On


AJAX:
Nach und nach werden einige Masken mit Ajax bedient. 
Das Paket xajax muß im CRM-Verzeichnis im Unterverzeichnis "xajax" installiert werden
oder per Link eingebunden werden.
Aktuell wird "xajax" mitgeliefert.


Wird mit einem Alias für das LxO-Verzeichnis benutzt und soll in einigen Masken der 
jscalendar der ERP benutzt werden, muß das Verzeichnis ins CRM-Verzeichnis verlinkt werden:
cd lx-office-crm
ln -s ../lx-office-erp/js


evtl. php.ini anpassen:
include_path = ".:/usr/share/php:/usr/share/fpdf:/usr/share/jpgraph"
extension=gd.so
.
.

Font für fpdf installieren (Debian):
cd /usr/share/php/Image/Canvas/Fonts
cp /usr/share/fonts/truetype/freefont/FreeSans.ttf .
echo FreeSans,FreeSans.ttf >> fontmap.txt 
 

Das TAR-File entpacken, dabei an HFS halten.
z.B. RPM-Systeme
	cd /srv/; tar xzf lx-office-crm-{version}.tgz
z.B. Debian
	cd /usr/lib/; tar xzf lx-office-crm-{version}.tgz

Crm in die ERP verlinken:
z.B. RPM-Systeme
	cd /srv/lx-office-erp; ln -s ../lx-office-crm crm
z.B. Debian
	cd /usr/lib/lx-office-erp; ln -s ../lx-office-crm crm

ERP-Menu erweitern:
	cd lx-office-erp
	mv menu.ini menu.ini.crm
	cat crm/update/menu140.ini menu.ini.crm > menu.ini

Menuicon kopieren
	cd lx-office-erp
	cp crm/image/CRM.png image/


Eigentümer der Datei auf Webserver setzen
z.B. Debian:
	chown -R www-data: crm/
Andere:
	apache, apache2, httpd, www-run

Im Browser die ERP aufrufen und anmelden
	 -http://localhost/lx-office-erp/login.pl

Melden Sie sich nun an LxO-ERP an und wählen Sie einen CRM-Menüeintrag aus.
Die Datenbankinstallation wird nun durchgeführt.

Geo-Datenbank:
--------------
In der Adressdatenmaske können einige Daten aus einer Geodatenbank gefüllt werden.
Dazu muß zuvor die Datenbank angelegt werden.

Dazu ein Terminalfenster öffnen oder per Fernzugriff auf dem Server auf der Konsole 
anmelden. In das Unterverzeichnis 'update' der CRM wechseln. Die Postgresql-Konsole 
mit der entsprechenden Datenbankinstanz aufrufen:
	psql -U <dbuser> -W <meinedb>
In der PostgreSQL-Konsole folgendes eingeben:
	\i GEO.sql
Es rasseln eine Menge Meldungen durch, es sollten keine Fehler auftreten.
Die Konsole mit '\q' verlassen.

Jetzt noch die inc/conf.php öffnen und den Wert hinter 'GEODB' auf 'true' ändern.

Jetzt erscheint in den Eingabemasken ein Knopf 'suche Ort'. Geben Sie in Plz, Ort oder
Vorwahl einen (Teil-)Begrif ein und klicken Sie auf den Knopf. In einem Pop-Up werden
die Treffer angezeigt. Wird ein Wert ausgewählt, wird in Plz,Ort,Vorwahl der dazugehörige 
Wert eingetragen.

BLZ-Datenbank:
--------------
In der Adressdatenmaske können einige Daten aus einer BLZ-Datenbank gefüllt werden.
Dazu muß zuvor die Datenbank angelegt werden.

Dazu ein Terminalfenster öffnen oder per Fernzugriff auf dem Server auf der Konsole 
anmelden. In das Unterverzeichnis 'update' der CRM wechseln. Die Postgresql-Konsole 
mit der entsprechenden Datenbankinstanz aufrufen:
	psql -U <dbuser> -W <meinedb>
In der PostgreSQL-Konsole folgendes eingeben:
	\i BLZ.sql
Es rasseln eine Menge Meldungen durch, es sollten keine Fehler auftreten.
Die Konsole mit '\q' verlassen.

Kopieren Sie die Datei update/blz.php nach <lx-office-erp>/lxo-import/ .
Erweitern Sie das LxO-Menü in der Sektion CSV-Import:

[System--Import CSV--BLZ]
module=lxo-import/blz.php

Jetzt noch die inc/conf.php öffnen und den Wert hinter 'BLZDB' auf 'true' ändern.

Melden Sie sich neu an. Holen Sie von :
http://www.bundesbank.de/
die aktuellen Bankleitzahlen. Rufen Sie das Programm "System->CSV-Import->BLZ" auf
und importieren Sie damit die Daten.

In der Bearbeitungsmaske der Firmen bekommen Sie nun unter "Sonstiges" einen neuen Knopf.


